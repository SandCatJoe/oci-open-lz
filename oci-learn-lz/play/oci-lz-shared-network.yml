# ####################################################################################################### #
# Copyright (c) 2023 Oracle and/or its affiliates,  All rights reserved.                                  #
# Licensed under the Universal Permissive License v 1.0 as shown at https: //oss.oracle.com/licenses/upl. #
# ####################################################################################################### #

---
network_configuration:
  default_enable_cis_checks: false
  default_freeform_tags:
    lz-data-type: staging
    lz-version: 0.1
  network_configuration_categories:
    HUB:
      category_compartment_id: CMP-SHARED-NETWORK-KEY
      category_freeform_tags:
        sub-environment: hub
      vcns:
        VCN-HUB-KEY:
          block_nat_traffic: false
          cidr_blocks:
          - 10.0.0.0/16
          display_name: lz-s-vcn-hub-lhr
          dns_label: hub
          is_ipv6enabled: false
          is_oracle_gua_allocation_enabled: false
 
          network_security_groups:
            NSG-01-HUB-VCN-KEY:
              display_name: nsg-01-hub-vcn
              egress_rules:
                anywhere:
                  description: egress to 0.0.0.0/0 over TCP
                  dst: 0.0.0.0/0
                  dst_type: CIDR_BLOCK
                  protocol: TCP
                  stateless: false
              freeform_tags: 
              ingress_rules:
                ssh_22:
                  description: ingress from 0.0.0.0/0 over TCP22
                  dst_port_max: 22
                  dst_port_min: 22
                  protocol: TCP
                  src: 0.0.0.0/0
                  src_type: CIDR_BLOCK
                  stateless: false
            NSG-02-HUB-VCN-KEY:
              display_name: nsg-02-hub-vcn
              egress_rules:
                anywhere:
                  description: egress to 0.0.0.0/0 over TCP
                  dst: 0.0.0.0/0
                  dst_type: CIDR_BLOCK
                  protocol: TCP
                  stateless: false
              ingress_rules:
                http_80:
                  description: ingress from 0.0.0.0/0 over HTTP8080
                  dst_port_max: 80
                  dst_port_min: 80
                  protocol: TCP
                  src: 0.0.0.0/0
                  src_type: CIDR_BLOCK
                  stateless: false
                https_443:
                  description: ingress from 0.0.0.0/0 over HTTPs443
                  dst_port_max: 443
                  dst_port_min: 443
                  protocol: TCP
                  src: 0.0.0.0/0
                  src_type: CIDR_BLOCK
                  stateless: false
                ssh_22:
                  description: ingress from 0.0.0.0/0 over TCP22
                  dst_port_max: 22
                  dst_port_min: 22
                  protocol: TCP
                  src: 0.0.0.0/0
                  src_type: CIDR_BLOCK
                  stateless: false
            NSG-03-HUB-VCN-KEY:
              display_name: nsg-03-hub-vcn
              egress_rules:
                anywhere:
                  description: egress to 0.0.0.0/0 over TCP
                  dst: 0.0.0.0/0
                  dst_type: CIDR_BLOCK
                  protocol: TCP
                  stateless: false
              ingress_rules:
                http_8080:
                  description: ingress from 0.0.0.0/0 over HTTP8080
                  dst_port_max: 80
                  dst_port_min: 80
                  protocol: TCP
                  src: 0.0.0.0/0
                  src_type: CIDR_BLOCK
                  stateless: false
                ssh_22:
                  description: ingress from 0.0.0.0/0 over TCP22
                  dst_port_max: 22
                  dst_port_min: 22
                  protocol: TCP
                  src: 0.0.0.0/0
                  src_type: CIDR_BLOCK
                  stateless: false
 
          default-security-list:
            display_name: seclist-def-fra-hub-vcn
            egress_rules: []
            ingress_rules:
            - stateless: false
              protocol: ICMP
              description: ICMP type 3 code 4
              src: 0.0.0.0/0
              src_type: CIDR_BLOCK
              icmp_type: 3
              icmp_code: 4
            - stateless: false
              protocol: ICMP
              description: ICMP type 3
              src: 10.0.0.0/18
              src_type: CIDR_BLOCK
              icmp_type: 3
              icmp_code: -1
            - stateless: false
              protocol: ICMP
              description: ICMP type 3
              src: 192.168.0.0/18
              src_type: CIDR_BLOCK
              icmp_type: 3
              icmp_code: -1
          security_lists:
            SECLIST-01-HUB-KEY:
              display_name: seclist-hub-network-lb
              egress_rules:
              - description: egress to 0.0.0.0/0 over ALL protocols
                dst: 0.0.0.0/0
                dst_type: CIDR_BLOCK
                protocol: ALL
                stateless: false
              freeform_tags: 
              ingress_rules:
              - description: ingress from 0.0.0.0/0 TCP protocol
                protocol: TCP
                src: 0.0.0.0/0
                src_type: CIDR_BLOCK
                stateless: false
            SECLIST-02-HUB-KEY:
              display_name: seclist-hub-network-firewall
              display_name: sl-02-hub-vcn
              egress_rules:
              - description: egress to 0.0.0.0/0 over TCP
                dst: 0.0.0.0/0
                dst_type: CIDR_BLOCK
                protocol: ALL
                stateless: false
              ingress_rules:
              - description: ingress from 0.0.0.0/0 over all ports
                protocol: ALL
                src: 0.0.0.0/0
                src_type: CIDR_BLOCK
                stateless: false

          route_tables:
            RT-HUB-DRG-KEY:
              display_name: rt-hub-drg
              route_rules:
#                rt_hub_def_sn
#                  description: Route outgoing traffic
#                  destination: 0.0.0.0/0
#                  destination_type: CIDR_BLOCK
#                  network_entity_id: "<NS PRIVATE IP OCID>"
#                rt_hub_lb_sn:
#                  description: Route incoming traffic to Hub LB subnet
#                  destination: 10.0.0.0/24
#                  destination_type: CIDR_BLOCK
#                  network_entity_id: "<NS PRIVATE IP OCID>"
            RT-HUB-LB-KEY:
              display_name: rt-hub-network-lb-lhr
              route_rules:
                internet_route:
                  network_entity_key: GATEWAY-HUB-INTERNET-KEY
                  description: Route for internet access
                  destination: 0.0.0.0/0
                  destination_type: CIDR_BLOCK
            RT-HUB-FW-NS-KEY:
              display_name: rt-hub-firewall
              route_rules: {}
            RT-HUB-FW-EW-KEY:
              display_name: rt-hub-firewall
              route_rules: {}
            RT-HUB-MGMT-KEY:
              display_name: rt-hub-firewall
              route_rules: {}
            RT-HUB-LOGS-KEY:
              display_name: rt-hub-firewall
              route_rules: {}

          subnets:
            SUBNET-HUB-LB-KEY:
              cidr_block: 10.0.0.0/24
              dhcp_options_key: default_dhcp_options
              display_name: sn-hub-lb
              dns_label: nlb
              ipv6cidr_blocks: []
              prohibit_internet_ingress: false
              prohibit_public_ip_on_vnic: false
              route_table_key: RT-HUB-LB-KEY
              security_list_keys:
              - SECLIST-01-HUB-KEY
            SUBNET-HUB-FW-NS-KEY:
              cidr_block: 10.0.1.0/24
              dhcp_options_key: default_dhcp_options
              display_name: sn-hub-fw-ns
              dns_label: nfwns
              ipv6cidr_blocks: []
              prohibit_internet_ingress: true
              prohibit_public_ip_on_vnic: true
              route_table_key: RT-HUB-FW-NS-KEY
              security_list_keys:
              - SECLIST-02-HUB-KEY
            SUBNET-HUB-FW-EW-KEY:
              cidr_block: 10.0.2.0/24
              dhcp_options_key: default_dhcp_options
              display_name: sn-hub-fw-ew
              dns_label: nfwew
              ipv6cidr_blocks: []
              prohibit_internet_ingress: true
              prohibit_public_ip_on_vnic: true
              route_table_key: RT-HUB-FW-EW-KEY
              security_list_keys:
              - SECLIST-02-HUB-KEY
            SUBNET-HUB-LOGS-KEY:
              cidr_block: 10.0.3.0/24
              dhcp_options_key: default_dhcp_options
              display_name: sn-hub-logs
              dns_label: lgs
              ipv6cidr_blocks: []
              prohibit_internet_ingress: true
              prohibit_public_ip_on_vnic: true
              route_table_key: RT-HUB-LOGS-KEY
              security_list_keys:
              - SECLIST-02-HUB-KEY
            SUBNET-HUB-MGMT-KEY:
              cidr_block: 10.0.4.0/24
              dhcp_options_key: default_dhcp_options
              display_name: sn-hub-mgmt
              dns_label: mgmt
              ipv6cidr_blocks: []
              prohibit_internet_ingress: true
              prohibit_public_ip_on_vnic: true
              route_table_key: RT-HUB-MGMT-KEY
              security_list_keys:
              - SECLIST-02-HUB-KEY

          vcn_specific_gateways:
            internet_gateways: 
              GATEWAY-HUB-INTERNET-KEY:
                enabled: true
                display_name: igw-hub
            nat_gateways:
              GATEWAY-HUB-NAT-KEY:
                block_traffic: false
                display_name: ngw-hub
            service_gateways:
              GATEWAY-HUB-SERVICE-GATEWAY:
                display_name: sg-hub
                services: all-services

      non_vcn_specific_gateways:
        dynamic_routing_gateways:
          DRG-FRA-HUB-KEY:
            display_name: drg-hub
            drg_attachments:
              DRG-FRA-HUB-VCN-FRA-HUB-KEY:
                display_name: drgatt-hub-vcn
                drg_route_table_key: DRG-RT-HUB-KEY
                network_details:
                  attached_resource_key: VCN-HUB-KEY
                  type: VCN
                  route_table_key: RT-HUB-DRG-KEY
            drg_route_distributions:
              IMPORT-HUB-RTD-KEY:
                display_name: import-rtd-hub
                distribution_type: IMPORT
                statements:
                  drg_route_distribution_vcn:
                    priority: 1
                    action: ACCEPT
                    match_criteria:
                      match_type: DRG_ATTACHMENT_TYPE
                      attachment_type: VCN
            drg_route_tables:
              DRG-RT-HUB-KEY:
                display_name: drg-rt-hub
                import_drg_route_distribution_key: IMPORT-HUB-RTD-KEY
                is_ecmp_enabled: false
                route_tables: {}
